# Простейший web-сервер. Hello World.

_В этой главе мы напишем, простейший web-сервер, который будет отдавать
HTML страницу содержащую текст "hello world"._

Код примера, приведенный ниже, находится в `src/basics/hello_world/main.go`.
```go
package main

import (
	"net/http"
)

func handler(w http.ResponseWriter, r *http.Request) {
	w.Write([]byte("hello world"))
}

func main() {
	http.HandleFunc("/", handler)
	http.ListenAndServe(":8080", nil)
}
```

Для запуска перейдите в рабочую директорию и наберите.

```bash
go run src/hello_world/main.go
```

Затем наберите в браузере http://localhost:8080 и вы увидете текст "hello world"

Разберем файл построчно. Первая строка `package main` это объявление имени пакета. Важно:

- только пакет с именем `main` может быть запущен командой `go run`;
- точкой входа всегда служит функция с именем `main`;
- любой файл должен начинаться с объявления имени пакета;
- имя пакета у всех файлов которые лежат в одной папке должно быть одинаковым.

Далее следует импорт пакета `net/http` из стандартной библиотеки который
отвечает за работу с `http`.

За ним следует объявление функциий `handler`, которая обрабатывает http запрос и функции
`main` которая служит точкой входа.

Для объявления функции ключевое слово `func`, сокращение от `function`. В Go вообще часто
применяются сокращения, особенно при названиях пакетов или перменных. В разделе
[имена переменных](https://github.com/golang/go/wiki/CodeReviewComments#variable-names)
рекомендаций по CodeReview для Go сказано:

>Короткие имена переменных в Go лучше чем длинные. Это особенно касается локальных
>переменных с ограниченной областью видимости. Лучше `c` чем `lineCount`. Лучше `i` чем `sliceIndex`.
>
>Базовое правило: чем дальше от объявления переменная используется, тем более наглядным
>должно быть имя. Для ресивера метода достаточно одной или двух букв. Такие переменные
>как индексы циклов или ридеры могут обозначаться одной буквой (`i`, `r`).
>Более необычные вещи и глобальные переменные нуждаются в более наглядных именах.

Рассмотрим код внутри функции `handler`. У функции `handler` есть два аргумента:

- `w` имеет тип `http.ResponseWriter`.
- `r` имеет тип `*http.Request`.

Обратите внимение на * перед указанием типа переменной. Это значит, что в функцию
передается _указатель_ на переменную.

В PHP когда в функцию передается объект, всегда передается ссылка (указатель) на объект.
То есть изменив объект внутри функции мы изменим исходный объект.
В Go всегда передается копия, если мы хотим передавать указатель, то
мы должны сделать это явно.

`http.ResponseWriter` - это _интерфейс_, а
`w` - это переменная тип которой которая реализует этот интерфейс.

---
Go строго типизированный язык, обязательно нужно указать тип переменной.

Если в PHP для отделения имени класса или функции от namespace используется "\", а для
отделения имени метода от имени класса "->", то в Go везде используется точка.
---

Интерфейсы в Go мало отличаются от интерфейсов в PHP. В дальнейшем мы рассмотрим
как объявлять и использовать интерфейсы, а так же их особенности в Go.

Структуру, для начала, можно рассматривать, как аналог класса в PHP, т.е, структура может
иметь свои методы, данные и реализовывать конкретный интерфейс.

Интерфейс `http.ResponseWriter` в стандартном пакете `http` имеет функцию `Write`, которой
мы воспользовались для вывода строки 'hello world'

```go
w.Write([]byte("hello world"))
```

Обратите внимаение, что Write принимает в качестве аргумента переменную имеющую тип
`[]byte` слайс байтов. Поэтому нам пришлось явно привести строку "hello world" к типу
`[]byte`.

---

В Go нет автоматического приведения типов. Все преобразования типов должны быть явные.
Приведение типа можно выполнить при указав нужны тип, а затем в скобках переменную.

Так же нужно понимать, что не все типы могут быть преобразованны таким образом,
например, так не получится преобразовать строку в целое, для этого прейдется воспользоваться
стандатным пакетом ```strconv```

---

 Request это структура у которой есть
методы для работы с http запросом, такие как получение get параметром, данных cookie
файлов и т д.


Рассмотрим код внутри функции `main`.

`http.HandleFunc("/", handler)` говорит web-серверу о том, что для обработки
корневых запросов нужно использовать нашу функцию `handler`

`http.ListenAndServe(":8080", nil)` - запускает web-сервера на порту 8080. Второй
переметр в данном случает нам не нужен, поэтому вместо указателя мы передаем `nil`


## Задание

Измените код функции handler так, чтобы вместо надписи "hello world" выводилась
надпись "hello" + текущий значение UserAgent браузера пользователя. Для получения значения
UserAgent воспользуйтесь методом `UserAgent` структуры `http.Request`
